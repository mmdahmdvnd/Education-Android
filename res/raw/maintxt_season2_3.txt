import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.ListView;
import android.widget.Toast;


public class Main extends Activity {
	
	
	private dbHandler db;
	private Button insert;
	private Button delete;
	private Button update;
	
	public  String[] name;
	public int[] id;
	
	private ListView list1;
	
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        insert=(Button) findViewById(R.id.main_insert);
    
        list1=(ListView) findViewById(R.id.list);
        db=new dbHandler(this);
       
       list1.setOnItemClickListener(new OnItemClickListener(){

//با کلیک روی هر آیتم از لیست ، کلاس contact بوسیله ی Intent باز میشود و id با مقدار آرگومان arg2 که همان شماره سطر کلیک شده است به این کلاس فرستاده میشود :
		@Override
		public void onItemClick(AdapterView<?> arg0, View arg1, int arg2,long arg3) {		

			Intent contact=new Intent(Main.this,contact.class);
			contact.putExtra("id", id[arg2]+"");
			startActivity(contact);	
		}   
       });
  
//کلیک روی کلید insert کلاس insert باز میشود :      
     
        insert.setOnClickListener(new OnClickListener(){
			public void onClick(View arg0) {
				
				Intent insert=new Intent(Main.this, insert.class);
				startActivity(insert);
			}
        });
        
    }
//متد ()refresh که در ()onResume فراخوانی شده به این منظور است که با برگشت از اکتیویتیهای دیگر (مثلا بعد از آبدیت کردن اطلاعات مخاطبین) ، مقادیر جدید و تغییر کرده ، در لیست نشان داده شوند و به اصطلاح refresh شود :
    public void refresh(){
        
    	db.open();
        int count=db.count();
        name=new String[count];
        id=new int[count];
        
   
        for(int i=0;i<count;i++){

//نام و فامیل مخاطب را در دو خط در سطر لیست قرار میدهد : 
        name[i]=db.Display(i,1)+"\n"+db.Display(i, 2);
        id[i]=Integer.parseInt(db.Display(i, 0));
        }
        db.close();
//ست کردن آدابتر را در بیرون از متد refresh نیز میتوان قرار داد(در ()onCreate) و چون زمان برگشت از سایر اکتیویتیها باید لیست به روز شود ، در اینجا قرار گرفته :
        list1.setAdapter(new ArrayAdapter<String>(this,android.R.layout.simple_list_item_1,name));
        }

//متد ()onResume زمان برگشت از اکتیویتیهای دیگر فراخوانی میشود : 
	@Override
	protected void onResume() {
		
		super.onResume();
		 refresh();
	}
    
    
    
}